!function(){"use strict";var a=angular.module("BowlingScoreboard.Website",[]).value("version","1.0.0.0");a.FrameObject=function(a,b,c,d,e,f,g){this.SrNo=a,this.FirstRoll=b,this.SecondRoll=c,this.ThirdRoll=d,this.Strike=e,this.Spare=f,this.TotalScore=g},a.directive("parentContainer",function(b,c,d,e,f){return{restrict:"C",scope:!0,link:function(g,h,i){var j=angular.fromJson(void 0!==i.jsonAppConfig?i.jsonAppConfig:"{}");g.addFrameButtonText=j.labels.addframebuttontext,g.frames=[],g.showAddFrame=!0,g.showCalculateButton=!1,g.disableAddFrame=!1,g.Strike=!1,g.Spare=!1,g.finalScore=0;var k=0,l=angular.element(h)[0].querySelector(".table-body");g.addFrameRowToScoreTable=function(){g.disableAddFrame=!0,k<10&&(c("../../Scripts/frame-row.tpl.html").then(function(a){var b=angular.element(a)[0];b.cells[0].innerHTML='<div class="frame-number">'+k+"</div>",k<=9&&(b.cells[3].innerHTML=""),angular.element(l).append(d(b)(g))}),k+=1),10===k&&(g.showAddFrame=!1,g.disableAddFrame=!0)},g.readAndProcessScore=function(){var a=angular.element(event.target)[0];m(a)},g.showResult=function(){g.finalScore=g.frames[g.frames.length-1].TotalScore};var m=function(b){var c=angular.element(h)[0].querySelector("#roll1"),d=angular.element(h)[0].querySelector("#roll2"),f=angular.element(h)[0].querySelector("#roll3"),i=parseInt(c.value),j=parseInt(d.value),l=0;if(o(i,j,b)){"undefined"!=typeof f&&null!==f&&i+j>=10&&(l=parseInt(f.value));var m="http://localhost:59595/api/framescore?firstrollpins="+i+"&secondrollpins="+j+"&thirdrollpins="+l+"&totalscore="+(g.frames.length>0?g.frames[g.frames.length-1].TotalScore.toString():"0")+"&strike="+(g.frames.length>0?g.frames[g.frames.length-1].Strike.toString():"false")+"&spare="+(g.frames.length>0?g.frames[g.frames.length-1].Spare.toString():"false")+"&pstrike="+(g.frames.length>1?g.frames[g.frames.length-2].Strike.toString():"false")+"&pspare="+(g.frames.length>1?g.frames[g.frames.length-2].Spare.toString():"false")+"&framenum="+k;e.get(m).then(function(e){var h=JSON.parse(e.data),m=new a.FrameObject(k,h.FirstRollPinsCount,h.SecondRollPinsCount,h.ThirdRollPinsCount,g.Strike,g.Spare,h.TotalScore);n(b,m,i,j,l),g.frames.push(m),g.disableAddFrame=!1,g.Strike=!1,g.Spare=!1,p(c,d,f),10===k&&(g.showCalculateButton=!0)})}},n=function(a,b,c,d,e){if(a.parentElement.parentElement.cells[4].innerHTML=b.TotalScore,g.frames.length>0){var f=b.TotalScore-c-d-e;if(g.frames[g.frames.length-1].Strike===!0||g.frames[g.frames.length-1].Spare===!0){var h=a.parentElement.parentElement.previousSibling;null!==h&&(h.cells[4].innerHTML=f)}}},o=function(a,b,c){return a+b>10&&10!==k?(g.errorVisible=!0,angular.element(h)[0].querySelector(".error-message").innerHTML="Invalid Score Entered",!1):(g.errorVisible=!1,c.disabled=!0,10!==a&&a+b===10&&(g.Spare=!0),10===a&&(g.Strike=!0),!0)},p=function(a,b,c){a.parentElement.innerHTML="<div>"+a.value+"</div>",b.parentElement.innerHTML="<div>"+b.value+"</div>","undefined"!=typeof c&&null!==c&&(c.parentElement.innerHTML="<div>"+c.value+"</div>")};b.startNewGame=function(){f.confirm("Are you sure you want to start new game?")&&f.location.reload()}}}})}();